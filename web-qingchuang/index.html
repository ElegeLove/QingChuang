<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>首页</title>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css"
        integrity="sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu" crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap-theme.min.css"
        integrity="sha384-6pzBo3FDv/PJ8r2KRkGHifhEocL+1X2rVCTTkUfGk7/0pbek5mMa1upzvWbrUbOZ" crossorigin="anonymous">
    <link rel="stylesheet" href="css/index.css">
    <script src="js/jquery-3.4.1.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/rem.js"></script>
    <script src="./js/getApi.js"></script>
</head>

<body>
    <div class="page1">
        <div class="title">
            <!-- <img src="./img/index_title_ng.png" alt="" srcset=""> -->
            <div class="title_text">
            </div>
        </div>
        <div class="main">
            <div class="list">
                <a class="openingEndPage" href="#">
                    <div class="list_items">开场白</div>
                </a>
                <a href="#">
                    <div class="list_items">倒计时</div>
                </a>
                <a class="signInWallPage is_sign_wall" href="signInWall.html">
                    <div class="list_items">签到墙</div>
                </a>
                <a class="goGuestShowPage is_show_guest" href="guestShow.html">
                    <div class="list_items">嘉宾展示</div>
                </a>
                <a class="programLinkPage is_segment" href="programLink.html">
                    <div class="list_items">节目环节</div>
                </a>
                <a class="shakeEnvelopePage is_red" href="javascript:;">
                    <div class="list_items">抢红包</div>
                </a>
                <a class="bigDrawPage is_lottery" href="bigDraw.html">
                    <div class="list_items">大抽奖</div>
                </a>
                <a class="messageWallPage is_message_wall" href="messageWall.html">
                    <div class="list_items">消息上墙</div>
                </a>
                <a class="excellencePage is_people_appraise" href="excellence.html">
                    <div class="list_items">评先评优</div>
                </a>
                <a class="programSelectionPage is_program_appraise" href="programSelection.html">
                    <div class="list_items">节目评选</div>
                </a>
                <a class="openingEndsPage" href="openingEnd.html">
                    <div class="list_items">结束语</div>
                </a>
            </div>
        </div>
        <!-- <div class="footer">
            <object type="text/x-scriptlet" data="./common/footer.html" width=100% height=90></object>
        </div> -->
        <div class="footerMain">
            <div class="footer">
                <div class="footerLeft">
                    <a href="index.html" class="footerLeft_items idnexPage">
                        <img src="./img/index.png" alt="" srcset="">
                        <p>首页</p>
                    </a>
                    <a href="openingEnd.html" class="footerLeft_items openingEndPage is_start">
                        <img src="./img/prologue.png" alt="" srcset="">
                        <p>开场白</p>
                    </a>
                    <a href="#" class="footerLeft_items">
                        <img src="./img/countdown.png" alt="" srcset="">
                        <p>倒计时</p>
                    </a>
                    <a href="signInWall.html" class="footerLeft_items signInWallPage is_sign_wall">
                        <img src="./img/signInWall.png" alt="" srcset="">
                        <p>签到墙</p>
                    </a>
                    <a href="guestShow.html" class="footerLeft_items goGuestShowPage is_show_guest">
                        <img src="./img/guestShow.png" alt="" srcset="">
                        <p>嘉宾展示</p>
                    </a>
                    <a href="messageWall.html" class="footerLeft_items messageWallPage is_message_wall">
                        <img src="./img/messageWall.png" alt="" srcset="">
                        <p>消息上墙</p>
                    </a>
                    <a href="programSelection.html" class="footerLeft_items programSelectionPage is_program_appraise">
                        <img src="./img/programSelection.png" alt="" srcset="">
                        <p>节目评选</p>
                    </a>
                    <a href="bigDraw.html" class="footerLeft_items bigDrawPage is_lottery">
                        <img src="./img/bigDraw.png" alt="" srcset="">
                        <p>大抽奖</p>
                    </a>
                    <a href="javascript:;" class="footerLeft_items shakeEnvelopePage is_red">
                        <img src="./img/redEnvelope.png" alt="" srcset="">
                        <p>摇红包</p>
                    </a>
                    <a href="programLink.html" class="footerLeft_items programLinkPage is_segment">
                        <img src="./img/programLink.png" alt="" srcset="">
                        <p>节目环节</p>
                    </a>
                    <a href="excellence.html" class="footerLeft_items excellencePage is_people_appraise">
                        <img src="./img/excellence.png" alt="" srcset="">
                        <p>评先评优</p>
                    </a>
                    <a href="openingEnd.html" class="footerLeft_items openingEndsPage is_end">
                        <img src="./img/peroration.png" alt="" srcset="">
                        <p>结束语</p>
                    </a>
                </div>
                <div class="footerRight">
                    <a href="javascript:;" class="footerLeft_items" onclick="startMusic()">
                        <img class="bigImg" src="./img/play.png" alt="" srcset="">
                        <p class="bigText">开始</p>
                    </a>
                    <a href="javascript:;" class="footerLeft_items" onclick="setVoice()">
                        <img src="./img/mute.png" alt="" srcset="">
                        <img class="imgVoice" src="./img/icon_prohibit.png" alt="">
                        <p>静音</p>
                    </a>
                    <a href="javascript:;" class="footerLeft_items" style="cursor: no-drop;">
                        <img src="./img/barrage.png" alt="" srcset="">
                        <img class="imgProhibit" src="./img/icon_prohibit.png" alt="">
                        <p>弹幕</p>
                    </a>
                    <a href="javascript:;" class="footerLeft_items" onclick="fullScreen()">
                        <img src="./img/fullScreen.png" alt="" srcset="">
                        <p>全屏</p>
                    </a>
                </div>
            </div>
        </div>
    </div>
    <script>
        $('.footer').hide();
        $('.footerMain').mouseover(function () {
            $('.footer').show();
        });
        $('.footerMain').mouseout(function () {
            $('.footer').hide();
        });
        var bgAudio = document.createElement('audio'); new Audio();
        bgAudio.setAttribute("src", './music/水一 - 左手指月 (Cover：萨顶顶).mp3');
        bgAudio.loop = false;
        // audio.controls = true;
        // audio.src = './music/水一 - 左手指月 (Cover：萨顶顶).mp3';
        // document.body.appendChild(audio);
        let flags = true;
        function startMusic() {
            if (flags) {
                bgAudio.play();
                bgAudio.volume = 0.3;
                $('.bigImg').attr('src', './img/suspend.png');
                $('.bigText').text('暂停');
            } else {
                bgAudio.pause();
                // 播放
                $('.bigImg').attr('src', './img/play.png')
                $('.bigText').text('开始');
            }
            flags = !flags;
        }
        bgAudio.addEventListener('ended', function () {
            $('.bigImg').attr('src', './img/play.png');
            $('.bigText').text('开始');
            flags = true;
        }, false);
        // 静音设置
        function setVoice() {
            if (bgAudio.volume > 0) {
                bgAudio.volume = 0;
                $('.imgVoice').css('display', 'block');
            } else {
                bgAudio.volume = 0.3;
                $('.imgVoice').css('display', 'none');
            }
        }
        // if (document.isFullScreen || document.mozIsFullScreen || document.webkitIsFullScreen) {
        //     fullscreen()
        // }else{
        //     console.log(document.isFullScreen || document.mozIsFullScreen || document.webkitIsFullScreen)
        // }
        // function quanping() {
        //     var flag = document.isFullScreen || document.mozIsFullScreen || document.webkitIsFullScreen;
        //     console.log(flag)
        //     return flag;
        // }
        // quanping();
        // var flag
        function fullScreen() {
            // flag = true;
            fullscreen()
        }
        function fullscreen() {

            // if (flag) {
            // var docElm = document.documentElement;
            // if (docElm.requestFullscreen) {
            //     //W3C
            //     docElm.requestFullscreen();
            // } else if (docElm.mozRequestFullScreen) {
            //     //FireFox
            //     docElm.mozRequestFullScreen();
            // } else if (docElm.webkitRequestFullScreen) {
            //     //Chrome等
            //     docElm.webkitRequestFullScreen();
            // } else if (elem.msRequestFullscreen) {
            //     //IE11
            //     elem.msRequestFullscreen();
            // } else {
            //     alert("浏览器不支持全屏API或已被禁用")
            // }

            // var rfs = docElm.requestFullScreen || docElm.webkitRequestFullScreen || docElm.mozRequestFullScreen || docElm.msRequestFullScreen,
            //     wscript;
            // if (typeof rfs != "undefined" && rfs) {
            //     rfs.call(docElm);
            //     return;
            // }
            // if (typeof window.ActiveXObject != "undefined") {
            //     wscript = new ActiveXObject("WScript.Shell");
            //     if (wscript) {
            //         wscript.SendKeys("{F11}");
            //     }
            // }

            var el = document.documentElement;
            var rfs = el.requestFullScreen || el.webkitRequestFullScreen || el.mozRequestFullScreen || el.msRequestFullscreen;
            if (typeof rfs != "undefined" && rfs) {
                rfs.call(el);
            };
            return;

            // var requestMethod = docElm.requestFullScreen || //W3C
            //     docElm.webkitRequestFullScreen || //Chrome等
            //     docElm.mozRequestFullScreen || //FireFox
            //     docElm.msRequestFullScreen; //IE11
            // if (requestMethod) {
            //     requestMethod.call(docElm);
            // } else if (typeof window.ActiveXObject !== "undefined") {//for Internet Explorer
            //     var wscript = new ActiveXObject("WScript.Shell");
            //     if (wscript !== null) {
            //         wscript.SendKeys("{F11}");
            //     }
            // }
            // }
            // elem = document.body;
            // if (elem.webkitRequestFullScreen) {
            //     elem.webkitRequestFullScreen();
            // } else if (elem.mozRequestFullScreen) {
            //     elem.mozRequestFullScreen();
            // } else if (elem.requestFullScreen) {
            //     elem.requestFullscreen();
            // } else {
            //     alert("浏览器不支持全屏API或已被禁用")
            // }
        }
        // window.onresize = function () {
        //     if (!checkFull()) {
        //         console.log(111112)
        //         //要执行的动作
        //         component.sendInfo();
        //         function stopDefault(e) {
        //             console.log(e)
        //             if (e && e.preventDefault) {
        //                 e.preventDefault();
        //             } else {
        //                 window.event.returnValue = false;
        //             }
        //             return false;
        //         }
        //     }
        // }
        function checkFull() {
            var isFull = document.fullscreenEnabled || window.fullScreen || document.webkitIsFullScreen || document.msFullscreenEnabled;
            //to fix : false || undefined == undefined
            if (isFull === undefined) { isFull = false; }
            return isFull;
        }

        // $(window).attr('location', "redEnvelope.html?activityId=" + activityId + "&userId=" + userId)

        //sArgName表示要获取哪个参数的值
        var sHref = window.location.href;
        //CuPlayer.com提示：测试数据
        //实际情况是用window.location.href得到URL
        var args = sHref.split("?");
        // var activityIds = "";
        // if (args[0] == sHref) /*参数为空*/ {
        //     return activityId; /*CuPlayer.com提示：无需做任何处理*/
        // }
        var str = args[1];
        var activityId = "";
        // var userId = "";
        // args = str.split("&");
        for (var i = 0; i < args.length; i++) {
            str = args[i];
            var arg = str.split("=");
            if (arg.length <= 1) continue;
            if (arg[0] == 'activityId') activityId = arg[1];
            // if (arg[0] == 'userId') userId = arg[1];
        }
        $('.idnexPage').attr('href', 'index.html?activityId=' + activityId);
        $('.signInWallPage').attr('href', 'signInWall.html?activityId=' + activityId);
        $('.goGuestShowPage').attr('href', 'guestShow.html?activityId=' + activityId);
        $('.messageWallPage').attr('href', 'messageWall.html?activityId=' + activityId);
        $('.programSelectionPage').attr('href', 'programSelection.html?activityId=' + activityId);
        $('.shakeEnvelopePage').attr('href', 'startShakeEnvelope.html?activityId=' + activityId);
        $('.bigDrawPage').attr('href', 'bigDraw.html?activityId=' + activityId);
        $('.programLinkPage').attr('href', 'programLink.html?activityId=' + activityId);
        $('.excellencePage').attr('href', 'excellence.html?activityId=' + activityId);
        $('.openingEndPage').attr('href', 'openingEnd.html?activityId=' + activityId + '&id=1');
        $('.openingEndsPage').attr('href', 'openingEnd.html?activityId=' + activityId + '&id=2');
        var page = document.querySelector('.page1');
        // $(document).ready(function () {
        //     // $(".footer").load("./common/footer.html");
        //     // console.log($(".footer").load())
        //     // page.style.width = $(document).width() + 'px';
        // })
        $(document).ready(function () {
            page.style.height = $(window).height() + 'px';
            // page.style.width = $(document).width() + 'px';
            $(window).resize(function () {  //当浏览器大小变化时
                page.style.height = $(window).height() + 'px';
            });
            // flag = true;
        })
        ajax({
            url: "screen/homePage", // url---->地址
            type: "POST", // type ---> 请求方式
            async: true, // async----> 同步：false，异步：true 
            data: { activity_id: activityId },
            success: function (res) { //返回接受信息
                res = JSON.parse(res);
                if (res.code == 0) {
                    $('.title_text').text(res.data.activity_name);
                    bgAudio.setAttribute("src", res.data.count_down_music);
                    $('.page1').css('background-image', 'url(' + res.data.screen_backgroud + ')');

                    if (res.data.is_sign_wall == 2) {
                        $('.is_sign_wall').css('display', 'none');
                    }
                    if (res.data.is_show_guest == 2) {
                        $('.is_show_guest').css('display', 'none');
                    }
                    if (res.data.is_people_appraise == 2) {
                        $('.is_people_appraise').css('display', 'none');
                    }
                    if (res.data.is_segment == 2) {
                        $('.is_segment').css('display', 'none');
                    }
                    if (res.data.is_red == 2) {
                        $('.is_red').css('display', 'none');
                    }
                    if (res.data.is_lottery == 2) {
                        $('.is_lottery').css('display', 'none');
                    }
                    if (res.data.is_message_wall == 2) {
                        $('.is_message_wall').css('display', 'none');
                    }
                    if (res.data.is_program_appraise == 2) {
                        $('.is_program_appraise').css('display', 'none');
                    }
                    if (res.data.is_start == 2) {
                        $('.is_start').css('display', 'none');
                    }
                    if (res.data.is_end == 2) {
                        $('.is_end').css('display', 'none');
                    }
                } else {
                    alert(res.msg);
                }

            }
        })
    </script>
</body>

</html>